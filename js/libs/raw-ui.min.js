/*
 * Licensed under the MIT License (MIT).
 * (http://opensource.org/licenses/MIT)
 * Copyright (c) JCThePants (github.com/JCThePants/rawUI)
 */
/* Included modules: general, required, controls, Popups, Select Control */
!function(e,t){var n=angular.module("rawUI",[]),r=angular.element,i=Object.defineProperty,a=function(e){return e},o=function(e){return"rui"+e[0].toUpperCase()+e.substr(1)};n.directive("a",function(){function e(e,t,n){t.on("click",function(e){return t.hasClass("disabled")?(e.stopImmediatePropagation(),!1):void("#"===n.href&&e.preventDefault())})}return{restrict:"E",link:e}}),function(){function i(n,i){function a(a,o,s){function p(){c&&o.css("height","auto")}function h(e){var t;if(!d){d=!0,e?(o.css("height","auto"),t=f(o).height,o.css("height",0).addClass("opening"),setTimeout(function(){o.addClass("open").css("height",t+"px")},1)):(t=f(o).height,o.addClass("closing").removeClass("open").css("height",0));var n=f(o).height,r=setInterval(function(){("auto"===t||n===f(o).height)&&(clearInterval(r),setTimeout(function(){o.removeClass("opening closing"),d=!1;var t=l(a);e!==t&&h(t)},10)),n=f(o).height},50)}}var u=s[t];if(!u)return void console.warn("transitionHeight directive requires an expression to evaluate.");var d,l=n(u),c=!1,f=i.rect;r(e).on("resize",p),a.$on("$destroy",function(){r(e).off("resize",p)}),l&&a.$watch(function(){return l(a)},function(e){h(c=e)})}return{restrict:"A",scope:!0,link:a}}var t=a("transitionHeight");n.directive(t,i),i.$inject=["$parse",o("utils")]}(),function(){function t(t,n){function r(r,i,a){var o=a[e];if(!o)return void console.warn("enable directive requires an expression to evaluate.");var s=t(o);r.$watch(function(){return s(r)},function(e){e?n.disable(i,!1):n.disable(i,!0)})}return{restrict:"A",scope:!1,link:r}}var e=a("enable");n.directive(e,t),t.$inject=["$parse",o("utils")]}(),function(){function t(t,n){function r(r,i,a){var o=a[e];if(!o)return void console.warn("disable directive requires an attribute value to evaluate.");var s=t(o);r.$watch(function(){return s(r)},function(e){e?n.disable(i,!0):n.disable(i,!1)})}return{restrict:"A",scope:!1,link:r}}var e=a("disable");n.directive(e,t),t.$inject=["$parse",o("utils")]}(),function(){function t(t){function n(n,r,i,a){var o=i[e];if(!o)return void console.warn("and directive requires expression to evaluate.");var s=t(o);n.$watch(function(){return s(n)},function(e){e||("radio"===r[0].type||"checkbox"===r[0].type||r[0].hasOwnProperty("checked")?(a.$setViewValue(!1),r[0].checked=!1):(a.$setViewValue(""),r[0].value=""))})}return{restrict:"A",require:"ngModel",scope:!0,link:n}}var e=a("and");n.directive(e,t),t.$inject=["$parse"]}(),function(){function t(e){function t(t,n,r,i){i.$formatters.push(function(e){return e?String(e):null}),i.$parsers.push(function(t){return e.parseInt(t,null)})}return{restrict:"A",scope:!1,require:"ngModel",link:t}}var e=a("intModel");n.directive(e,t),t.$inject=[o("utils")]}(),function(){function t(t,n){function r(r,i,a){function u(e){e.preventDefault(),i.hasClass("disabled")||n.triggerUpdate(function(){var e=!s(r);s.assign(r,e),i.toggleClass("active",e)})}var o=a[e];if(!o)return void console.warn("toggle directive requires an expression to evaluate.");var s=t(o);i.on("click",u)}return{restrict:"A",scope:!1,link:r}}var e=a("toggle");n.directive(e,t),t.$inject=["$parse",o("utils")]}(),function(){function t(t,n,r){function i(i,a,o){function f(){a.hasClass("disabled")||(c&&n.cancel(c),c=n(function(){u.assign(i,!0),a.addClass("active"),c=null},l))}function d(){a.hasClass("disabled")||(c&&n.cancel(c),c=n(function(){u.assign(i,!1),a.removeClass("active"),c=null},l))}var s=o[e];if(!s)return void console.warn("hoverToggle directive requires an expression to evaluate.");var c,u=t(s),l=0;a.on("mouseenter",f).on("mouseleave",d),o.$observe("toggleDelay",function(e){l=r.parseInt(e,0)})}return{restrict:"A",scope:!1,link:i}}var e=a("hoverToggle");n.directive(e,t),t.$inject=["$parse","$timeout",o("utils")]}(),function(){function e(e){function s(e,t,n){t=t instanceof Array?t:[t];for(var r=0;r<e.length;r++)for(var i=0;i<t.length;i++)if(n&&n(e[r],t[i])||e[r]===t[i])return!0;return!1}function u(e,t){e=n.getDomElem(e);var i=r(e.querySelectorAll("input,a,select,textarea,button,label"));i.push(e),i.toggleClass("disabled",t).prop("disabled",t),t?i.attr("disabled","disabled").on("click",n.stopEvent):i.removeAttr("disabled").off("click",n.stopEvent)}function l(e,r){e=n.getDomElem(e);var i=t.defaultView;return i&&i.getComputedStyle?i.getComputedStyle(e,"").getPropertyValue(r):e.currentStyle?(r=r.replace(/\-(\w)/g,function(e,t){return t.toUpperCase()}),e.currentStyle[r]):""}function c(e,t){for(var r=t.target;r;){if(r===n.getDomElem(e))return!0;r=r.parentNode}return!1}function f(e){return e=n.getNgElem(e),e.attr("disabled")||e.hasClass("disabled")||e[0].disabled}function d(e){return n.is(e,"string")?(e=e.toLowerCase(),""!==e&&"false"!==e&&"no"!==e&&"off"!==e):e?!0:!1}function p(e){return n.getDomElem(e).getBoundingClientRect()}function h(e,t,n){t=t instanceof Array?t:[t];for(var r=[],i=0;i<e.length;i++)for(var a=0;a<t.length;a++)if(n&&n(e[i],t[a])||e[i]===t[a]){r.push(e.splice(i,1)[0]),i--;break}return r}function v(t){t&&a.callbacks.push(t),a.promise||(a.promise=e(a.callback,1))}function g(e,t){function n(n){i(t,n,{get:function(){return e[n]},set:function(t){e[n]=t}})}for(var r in e)0!==r.indexOf("_")&&("function"==typeof e[r]?t[r]=e[r]:n(r))}var n=this,a={promise:null,callbacks:[],callback:function(){for(a.promise=null,a.callbacks.reverse();a.callbacks.length;)a.callbacks.pop()()}},o=function(){for(var r,e=["matches","msMatches","webkitMatches","mozMatches"],n=0;r=e[n];n++)if(r+="Selector",t.body[r])return r;throw"Valid matchesSelector function not found for current browser."}();this.getStyle=l,this.rect=p,this.stopEvent=function(e){e.preventDefault(),e.stopImmediatePropagation()},this.disable=u,this.isDisabled=f,this.isClicked=c,this.is=function(e,t){return typeof e===t},this.isProto=function(e,t){return Object.prototype.toString.call(e)===t},this.isDefined=function(e){return!n.is(e,"undefined")},this.hasAttr=function(e,t){return e=r(n.getDomElem(e)),n.isDefined(e.attr(t))||n.isDefined(e.attr("data-"+t))},this.getAttr=function(e,t){return e=n.getNgElem(e),e.attr(t)||e.attr("data-"+t)},this.pointerX=function(e){var r=n.isDefined(e.touches),i=t.documentElement.scrollLeft||t.body.scrollLeft;return((r?e.touches[0].clientX:e.pageX)||0)-(r?0:i)},this.pointerY=function(e){var r=n.isDefined(e.touches),i=t.documentElement.scrollTop||t.body.scrollTop;return((r?e.touches[0].clientY:e.pageY)||0)-(r?0:i)},this.parseBool=d,this.parseInt=function(e,t){return e=parseInt(e,10),isNaN(e)?t:e},this.parseFloat=function(e,t){return e=parseFloat(e),isNaN(e)?t:e},this.triggerUpdate=v,this.pushAll=function(e,t){t=t instanceof Array?t:[t];for(var n=0;n<t.length;n++)e.push(t[n])},this.spliceAll=h,this.arrayContains=s,this.matches=function(e,t){return e=n.getDomElem(e),e[o](t)},this.getDomElem=function(e){return e?e.nodeType?e:e[0]:e},this.getNgElem=function(e){return e&&e.nodeType?r(e):e},this.wrap=g,this.endsWith=function(e,t){return-1!==e.indexOf(t,e.length-t.length)}}n.service(o("utils"),e),e.$inject=["$timeout"]}(),function(){function e(e){function s(e,t,n,r){for(var c,s=l(e,t),u=0;c=s[u];u++)o[c]={get:n||a.get,set:r||a.set};i="";for(var c in o)i+=i?",":"",i+=c}function u(e,t){var n=l(e,t);return n.join(",")}function l(e,t){var n=[];return-1!==e.indexOf("E")&&n.push(t),e.indexOf(!0)&&(n.push("["+t+"]"),n.push("[data-"+t+"]")),e.indexOf(!0)&&(n.push("."+t),n.push("."+function(){for(var r,e=t.split("-"),n=1;r=e[n];n++)r.length&&(e[n]=r[0].toUpperCase()+r.substr(1));return e.join("")}())),n}function c(t){return t=e.getNgElem(t),e.matches(t,n.getQuerySelector())?t:r(t[0].querySelector(n.getQuerySelector()))}function f(e){var t=p(e);return t?t.get(e):null}function d(e,t){var n=p(e);n&&n.set(e,t)}function p(t){t=e.getNgElem(t);var n=t[0],r=t.prop("ruiInputHandlers");if(r)return r;for(var i in o)if(e.matches(n,i)){r=o[i];break}return t.prop("ruiInputHandlers",r),r}function h(n){if(n=e.getNgElem(n),"radio"===n.attr("type")){var r=n.attr("name");if(r){var i=t.body.querySelectorAll('input[name="'+r+'"]:checked');return i.length?i[0].value:null}}else if("checkbox"===n.attr("type"))return n[0].checked;return n[0].value}function v(n,i){if(n=e.getNgElem(n),"radio"===n.attr("type")){var a=n.attr("name");if(a)for(var u,o=r(t.getElementsByName(a)),s=0;u=o[s];s++){var l=String(u.value)===String(i);u.checked!==l&&(u.checked=l)}}else"checkbox"===n.attr("type")?n[0].checked=i:n[0].value=i}var n=this,i="input,select,textarea",a={get:h,set:v},o={input:a,select:a,textarea:a};this.register=s,this.getQuerySelector=function(){return i},this.createQuerySelector=u,this.findControl=c,this.getValue=f,this.setValue=d}n.service(o("inputControls"),e),e.$inject=[o("utils")]}(),function(){function t(e){function t(t,n){var r=e.findControl(n);r.length&&t.$watch(function(){return e.getValue(r)},function(e){n.toggleClass("has-value",e)})}return{restrict:"AC",scope:!0,link:t}}var e=a("control");n.directive(e,t),t.$inject=[o("inputControls")]}(),function(){function i(n){function s(e){var n=t.getElementById(e);if(n)for(var r in o)if(o[r]&&e!==r){var a=t.getElementById(r);if(a)for(;a;){if(a===n){i.close(r);break}a=a.parentElement}}}function u(e){for(var n,t=0;n=a[t];t++)if(n.id===e)return!0;return!1}function l(e,t){for(var n in o)n===e||!t&&u(n)||c(n,!1);a.length=0}function c(e,n,i){return setTimeout(function(){o[e]=n;var i=r(t.getElementById(e));i.toggleClass("open",n)},i||0),n}var i=this,a=[],o={};this.toggle=function(e,t){return l(e),c(e,n.isDefined(t)?t:!o[e],3)},this.open=function(e){return o[e]?void 0:(l(e),c(e,!0,3))},this.close=function(e){o[e]&&c(e,!1,3)},this.keepOpen=function(e,t){a.push({id:e,parentId:t})},this.closeChildren=s,this.isOpen=function(e){return o[e]},this.isPopup=function(e){return r(e[0]||e).prop("isPopupElement")},e.addEventListener("click",function(e){for(var t=e.target;t;){if(i.isPopup(t))return;t=t.parentElement}l(null,!0)})}n.service(o("popups"),i),i.$inject=[o("utils")]}(),function(){function t(e){function t(t,n,r){var i;r.$observe("id",function(t){i&&(e.close(i),n.removeClass("open")),i=t}),n.prop("isPopupElement",!0).on("click",function(t){if(!i)return void console.warn("popup-box directive requires ID attribute.");for(var r=t.target;r&&r!==n[0];){if(e.isPopup(r))return;r=r.parentElement}t.stopPropagation(),e.closeChildren(i)})}return{restrict:"EAC",link:t}}var e=a("popupBox");n.directive(e,t),t.$inject=[o("popups")]}(),function(){function t(t,n){function a(t,a,o){var s;o.$observe(e,function(e){s=e}),a.prop("isPopupElement",!0).on("click",function(e){if(e.preventDefault(),!s)return void console.warn("popupButton directive requires attribute value to point to popup box ID attribute.");for(var o,t=e.target;t;){if(o=r(t),i(o.attr("data-popup-box"))||o.hasClass("disabled"))return;if(t===this)break;t=t.parentElement}for(t=a[0];t;){if(o=r(t),o.hasClass("disabled"))return;o.prop("isPopupElement")&&n.keepOpen(t.id,s),t=t.parentElement}e.stopPropagation(),a.toggleClass("active",n.toggle(s))})}var i=t.isDefined;return{restrict:"A",link:a}}var e=a("popupButton");n.directive(e,t),t.$inject=[o("utils"),o("popups")]}(),function(){function s(e,n,a){function s(e,a){function u(){return s}function l(e){e=n.parseBool(e),e?f():d()}function c(){return a.hasClass("disabled")}function f(){s=!0,a.addClass("open"),setTimeout(function(){e.selectDropdown.css("width",n.rect(a).width+"px"),o.bind("click",d)},1),e.$apply()}function d(){s=!1,a.removeClass("open"),o.unbind("click",d),setTimeout(function(){e.selectDropdown.css("width",n.rect(a).width+"px")},1),e.$apply()}var o=r(t),s=!1;i(this,"isOpen",{get:u,set:l,enumerable:!0}),i(this,"isDisabled",{get:c,enumerable:!0})}function u(t,i,a,s){function d(e){f&&f.removeAttr("data-selected"),f=r(c[0].querySelector('li[data-value="'+e+'"]')),0!==f.length?(l.html(f.html()),i.addClass("has-value")[0].value=e,f.attr("data-selected","true")):(l.text(""),i.removeClass("has-value")[0].value=e)}function p(){return u.isDisabled?void(u.isOpen=!1):void(u.isOpen=!u.isOpen)}function h(o){o.stopImmediatePropagation();for(var p,d=o.target;d&&d!==c[0];){if("LI"===d.tagName&&d.parentNode===c[0]){p=r(d);break}d=d.parentNode}if(p){f.removeAttr("data-selected"),f=p.attr("data-selected",!0),l.html(f.html());var h=i[0].value=n.getAttr(f,"value")||(n.isDefined(f[0].value)?f[0].value:f.text());s.$setViewValue(h),i.addClass("has-value")[0].value=h,u.isOpen=!1,a.onSelect&&e(a.onSelect)(t)}}var f,u=t.select,l=r(i[0].querySelector(".value")),c=r(i[0].querySelector("ul,ol"));return 0===c.length?void console.warn("select-box requires unordered or ordered list element as child."):(i.prepend(r('<span class="select-button"></span>')).css("z-index",o--),0==l.length&&i.prepend(l=r('<span class="value"></span>')),t.selectDropdown=c,t.selectLabel=l,i.on("click",p),c.on("click",h),d(s.$modelValue),t.$watch(function(){return s.$modelValue},function(e){d(e)}),void t.$watch(function(){return i[0].value},function(e){d(e)}))}var o=200;return a.register("EAC","select-box"),{restrict:"EAC",require:"ngModel",scope:!0,controller:["$scope","$element",s],controllerAs:"select",link:u}}var e=a("selectBox");t.registerElement&&t.registerElement("select-box"),n.directive(e,s),s.$inject=["$parse",o("utils"),o("inputControls")]}()}(window,document);